## 原理介绍

这是一个多级菜单框架,通过命令行界面进行交互。使用了树的数据结构来表示菜单的层级关系,每个节点代表一个菜单选项,每个节点可以有多个子节点（选项）。用户可以通过上下箭头键选择菜单选项,并通过回车键执行相应的功能。

主要的数据结构包括：

- `Menu`：菜单选项的结构体,包含菜单名称、菜单消息以及菜单选项的数量和相关信息。
- `Node`：菜单选项节点的结构体,包含指向父节点的指针、指向子节点的指针数组、当前选中的选项索引以及与该选项相关联的菜单结构体。

主要函数包括：

- `New_Node()`：创建一个新的菜单选项节点,并初始化相关数据。
- `Connect_Node()`：连接两个菜单选项节点,建立父子节点的关系。
- `Set_Name()`：设置菜单选项节点的名称。
- `Set_Message()`：设置菜单选项节点的消息。
- `Set_Selection()`：设置菜单选项节点的具体选项。
- `Set_Number_Selection()`：设置菜单选项节点的选项数量。
- `Init()`：初始化菜单系统。
- `Clear()`：清屏函数,清除终端上的内容。
- `flush()`：刷新菜单显示,根据当前选中的菜单节点显示菜单选项。
- `Function()`：执行菜单选项对应的功能。
- `Loop()`：进入菜单循环,等待用户的输入并处理。

## 使用方法

1. 在 `menu.c` 文件中定义菜单结构和功能函数。
2. 在 `SetMenu.h` 函数中通过调用 `Init()` 进行菜单系统的初始化,通过调用 `New_Node()` 创建新的菜单选项节点,并通过其他`Set`函数设置菜单选项的名称、消息、选项等信息。并通过调用 `Connect_Node()` 建立菜单选项之间的父子关系。
3. 在 `main` 函数中调用 `Loop()` 进入菜单循环,等待用户的输入并处理相应的功能函数。

## 扩展方法

该菜单框架可以通过以下方式进行扩展：

1. 扩展功能函数：可以在 `menu.c` 中添加新的功能函数,根据需要执行不同的操作。在 `Function()` 中添加相应的逻辑,根据选项的索引调用不同的功能函数。
2. 修改界面显示：可以通过修改 `flush()` 函数中的显示逻辑,调整菜单选项的样式和显示方式。
3. 适配不同终端：可以修改 `Clear()` 和 `flush()` 函数,使其适配不同的终端环境。
4. 错误处理和边界情况：目前的代码没有对输入错误或边界情况进行处理,可以根据需要添加相应的错误处理逻辑和边界情况的检查。
5. 下面是需要修改的部分
>`menu.h`:
>- #include "`实现功能需要的函数`"
>- #define `Number_Selection_Max` 5<br>*决定你选项的最高数量*
>- void `Clear()`;<br>*修改清屏的函数以适应不同设备*
>- void `flush()`;<br>*修改菜单刷新显示以适应不同设备*
>- void `Function()`;<br>*添加功能*<br><br>
>`SetMenu.h`:
>
>- `Init();`
>- Node *`Main` = New_Node();
>- Set_Name(`Main`, "`菜单名字`");
>- Set_Message(`Main`, "`菜单显示信息`");
>- Set_Number_Selection(`Main`, `菜单选项数量`);
>- Set_Selection(`Main`, "`选项名称`", `选项序号`, `功能序号`, `功能传参`);
>- Connect_Node(`主菜单`, `子菜单`, `菜单序号`);
>- `Current_pNode = Main;`


## Debug
`2023.6.24`  
- 该框架有一个malloc语句始终无法运行，写入message，name等数据时正常运行，且在vscode的debug模式可以运行，无法在终端中运行(`ouput/main`)，debug时该函数申请的内存末端在调试台显示"`incomplete sequence`"，后来将`(char *)malloc(sizeof(pString))`修改成`malloc(strlen(pString) + 1)`后解决该问题，估测是sizeof返回的大小不完整，导致malloc错误
- 框架在vscode运行良好，直接运行生成的exe文件则会出现几种奇怪的情况，一是终端闪出来停滞了几秒随后结束进程，二是进程结束提示并返回错误代码`3221226356`，三是终端消失后进程并未结束，通过win任务管理器查看该程序CPU占用近15%，经过数小时的debug后发现打印`\033[2J`来实现清屏会导致终端宕机,用windows.h中的`system("cls")`即可正常运行


## 后期
- 2023.7.1追加 主要修改的是渲染方式和`Loop`逻辑，框架挺稳定的，功能实现起来也不复杂，不过得尽早出一个使用文档，方便后期查阅